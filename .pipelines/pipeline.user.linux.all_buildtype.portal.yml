# Reference: https://onebranch.visualstudio.com/Pipeline/_wiki/wikis/Pipeline.wiki/308/Pipeline-Spec-YAML-Stage-Commands

restore:
  commands:
    - !!defaultcommand
      name: "portal restore"
      command: "build/portal/restore.sh"

build:
  commands:
    - !!buildcommand
      name: "portal build"
      command: "build/portal/build.sh"
      artifacts:
        - from: "bin/release/VsClk.Portal.WebSite/publish"
          to: "portal"
          include:
            - "**/*"
        - from: "src/Portal/PortalWebsite/Src/Website/build"
          to: "portal/ClientApp/build"
          include:
            - "**/*"

test:
  commands:
    - !!testcommand
      name: "portal test"
      command: "build/portal/test.sh"
      testresults:
        - from: "bin/release/testresults"
          title: "Test Results"
          type: "vstest"
          include:
            - "*.trx"
        - from: 'src/Portal/PortalWebsite/Src/Website/'
          title: 'Portal Test Results'
          type: 'JUnit'
          include:
            - 'packages/*/junit.xml'

static_analysis_options:
  moderncop_options:  
    disable_tool_scan: true

package_sources:
  npm:
    config_files:
        - include:
          - 'src/services/containers/VsClk.Portal.WebSite/ClientApp/.npmrc'
          - 'src/Portal/PortalWebsite/Src/Website/.npmrc'
