#function("Tabulates resume of codespaces by Sku per hour")
(T:(EventAtResumeRequestStop_ResponseCode: int, TimeStamp: datetime, ResponseOutcome: string, ResumeOutcome: string, SkuName: string))
{
    T 
    | where TimeStamp < ago(1h)
    | where EventAtResumeRequestStop_ResponseCode != 307
    | where ResumeOutcome == "Available" and ResponseOutcome == "Success"
    | project SkuName, TimeStamp
    | summarize count() by SkuName, bin(TimeStamp, 1h)
}