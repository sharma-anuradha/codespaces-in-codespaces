#include("..\Raw\ScopedRawEvents_7Days.ksf")
let GetAllStateTransitionEvents = () { 
    ScopedRawEvents
        | where msg == "environmentstatemanager_setenvironmentstateasync"
        | project CloudEnvironmentOldState, CloudEnvironmentNewState, ['time'], WorkspaceId, CloudEnvironmentFailedStateReason, HttpRequestMethod, HttpRequestUri, CorrelationId, CloudEnvironmentId, SkuName
        | summarize arg_max(['time'], *) by CloudEnvironmentOldState, CloudEnvironmentNewState, WorkspaceId, CorrelationId, CloudEnvironmentId
};
